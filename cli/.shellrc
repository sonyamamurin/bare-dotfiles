# General env
export VISUAL=vim
export EDITOR="$VISUAL"

export LC_ALL=en_US.UTF-8
export LANG=en_US.UTF-8

eval `dircolors $HOME/.dircolors.dark256`

dotfiles_dir=$HOME/tetov-dotfiles

# Load variables containing server adresses and user names
if [ -f "$HOME/.confidentials" ] ; then
    . $HOME/.confidentials
else
    echo ".confidentials not found in ~"
fi

export SSH_AUTH_SOCK="$XDG_RUNTIME_DIR/ssh-agent.socket"

# Update path only if path not present
_path_assign() { oFS=$IFS ; IFS=: ; add=$* ; unset P A ; A=
    set -- ${PATH:=$1} ; for p in $add ; do {
        [ -z "${p%-[AP]}" ] && { unset P A
                eval ${p#-}= ; continue ; }
        for d ; do [ -z "${d%"$p"}" ] && break
        done ; } || set -- ${P+$p} $* ${A+$p}
        done ; export PATH="$*" ; IFS=$oFS
}

_path_assign \
    $HOME/bin \
    $dotfiles_dir/bin

# https://stackoverflow.com/a/20460402
stringContain() { [ -z "${2##*$1*}" ] && [ -z "$1" -o -n "$2" ]; }

# aliases
alias ll='ls -lh'
alias la='ls -A'
alias l='ls'
alias mkdir='mkdir -pv'
alias rmi='rm -i'
alias cp='cp -i'
alias mv='mv -i'
alias ..='cd ..'
alias _='sudo '

alias ls='ls -F --color=auto'
alias grep='grep -i --color=auto --exclude-dir={.bzr,CVS,.git,.hg,.svn}'

alias cpc='xclip -selection c'

# rtcontrol
alias rthot="watch -n30 'rtcontrol -rs up,down,name xfer=+0 2>&1'"
alias rtmsg="rtcontrol -s alias,message,name 'message=?*' 'message=!*Tried?all?trackers*'"
alias rtmsgstats="rtcontrol -q -s alias,message -o alias,message 'message=?*' 'message=!*Tried?all?trackers*' | uniq -c"
alias rt2days="rtcontrol --column-headers -scompleted -ocompletion completed=-2d"
alias rtstats="rtcontrol -q -o alias -s alias \\* | uniq -c"
alias rti="rtcontrol is_complete=no"
alias rttrump='rtcontrol -s alias,message,name message="*nregistered*"'

# plex
alias notlinked='find . -type f -links 1 \( \! -iname "*.jpg" \! -iname "*.nfo" \! -iname "*.png" \! -iname "*.srt" \)'

# tripwire
alias trippy='sudo tripwire -m c -I'
alias trippyaf='sudo apt-get update && sudo apt-get upgrade -y && sudo tripwire -m c -I'

function open () {
    if command -v xdg-open >/dev/null ; then
        xdg-open "$*" &
    elif command -v cmd.exe >/dev/null ; then
        # based on https://superuser.com/questions/1160419/how-can-i-open-a-file-from-wsl-with-the-default-application#comment1846408_1252579
        readlink -f "$*" | sed -e 's/\/mnt\/\(.\)/\1:/1' -e 's/.*/\"&\"/g' | xargs cmd.exe /c start ""
    else
        echo "open command not set up for this env"
    fi
}

# git
alias g='git'

alias ga='git add'

alias gb='git branch'

alias gc='git commit -v'
alias gcmsg='git commit -m'
alias gco='git checkout'

alias gd='git diff'

alias gf='git fetch'

alias gl='git pull'

alias gp='git push'

alias gr='git remote'
alias gra='git remote add'
alias grb='git rebase'

alias gst='git status'

# vi:syntax=sh
